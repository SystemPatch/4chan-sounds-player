// ==UserScript==
// @name         4chan sounds player
// @version      1.5.4
// @namespace    rccom
// @description  Play that faggy music weeb boi
// @author       RCC
// @match        *://boards.4chan.org/*
// @match        *://boards.4channel.org/*
// @match        *://desuarchive.org/*
// @match        *://arch.b4k.co/*
// @match        *://archived.moe/*
// @grant        GM.getValue
// @grant        GM.setValue
// @run-at       document-start
// @updateURL    https://raw.githubusercontent.com/rcc11/4chan-sounds-player/master/dist/4chan-sounds-player.meta.js
// @downloadURL  https://raw.githubusercontent.com/rcc11/4chan-sounds-player/master/dist/4chan-sounds-player.user.js
// ==/UserScript==

!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){function n(e){try{const t=e.parentElement.parentElement;if("qp"===t.id||t.classList.contains("inline")||e.parentElement.classList.contains("noFile"))return;let n=null;if(is4chan)isChanX?[e.querySelector(".fileText .file-info .fnfull"),e.querySelector(".fileText .file-info > a")].some((function(e){return e&&(n=e.textContent)})):[e.querySelector(".fileText"),e.querySelector(".fileText > a")].some((function(e){return e&&(n=e.title||"A"===e.tagName&&e.textContent)}));else{const t=e.querySelector(".post_file_filename");n=t&&t.title}if(!n)return;n=n.replace(/\-/,"/");const r=n.match(/^(.*)[\[\(\{](?:audio|sound)[ \=\:\|\$](.*?)[\]\)\}]/i);if(!r)return;const o=e.id.slice(is4chan?1:0),a=r[1]||o,s=e.querySelector(is4chan?".fileThumb":".thread_image_link"),l=s&&s.href,i=s&&s.querySelector("img").src;let d=r[2];if(d.includes("%"))try{d=decodeURIComponent(d)}catch(e){return}null===d.match(/^(https?\:)?\/\//)&&(d=location.protocol+"//"+d);try{d=new URL(d)}catch(e){return}for(let e of Player.config.allow)if(d.hostname.toLowerCase()===e||d.hostname.toLowerCase().endsWith("."+e))return Player.add(a,o,d.href,i,l)}catch(t){_logError("There was an issue parsing the files. Please check the console for details."),console.log("[4chan sounds player]",e),console.error(t)}}e.exports={parseFiles:function(e){e.querySelectorAll(".post").forEach(n)},parsePost:n}},function(e,t){e.exports=[{property:"shuffle",default:!1},{property:"repeat",default:"all"},{property:"viewStyle",default:"playlist"},{property:"hoverImages",default:!1},{property:"autoshow",default:!0,title:"Autoshow",description:"Automatically show the player when the thread contains sounds.",showInSettings:!0,settings:[{title:"Enabled"}]},{property:"pauseOnHide",default:!0,title:"Pause on hide",description:"Pause the player when it's hidden.",showInSettings:!0,settings:[{title:"Enabled"}]},{property:"limitPostWidths",title:"Limit Post Width",description:"Limit the width of posts so they aren't hidden under the player.",showInSettings:!0,settings:[{property:"limitPostWidths",title:"Enabled",default:!1},{property:"minPostWidth",title:"Minimum Width",default:"50%"}]},{title:"Keybinds",showInSettings:!0,description:"Enable keyboard shortcuts.",format:"hotkeys.stringifyKey",parse:"hotkeys.parseKey",class:ns+"-key-input",property:"hotkey_bindings",settings:[{property:"hotkeys",default:"open",handler:"hotkeys.apply",title:"Enable",format:null,parse:null,class:null,options:{always:"Always",open:"Only with the player open",never:"Never"}},{property:"hotkey_bindings.playPause",title:"Play/Pause",keyHandler:"togglePlay",ignoreRepeat:!0,default:{key:" "}},{property:"hotkey_bindings.previous",title:"Previous",keyHandler:"previous",ignoreRepeat:!0,default:{key:"arrowleft"}},{property:"hotkey_bindings.next",title:"Next",keyHandler:"next",ignoreRepeat:!0,default:{key:"arrowright"}},{property:"hotkey_bindings.volumeUp",title:"Volume Up",keyHandler:"hotkeys.volumeUp",default:{shiftKey:!0,key:"arrowup"}},{property:"hotkey_bindings.volumeDown",title:"Volume Down",keyHandler:"hotkeys.volumeDown",default:{shiftKey:!0,key:"arrowdown"}},{property:"hotkey_bindings.togglePlayer",title:"Show/Hide",keyHandler:"display.toggle",default:{key:"h"}},{property:"hotkey_bindings.togglePlaylist",title:"Toggle Playlist",keyHandler:"playlist.toggleView",default:{key:""}},{property:"hotkey_bindings.toggleHoverImages",title:"Toggle Hover Images",keyHandler:"playlist.toggleHoverImages",default:{key:""}}]},{property:"footerTemplate",title:"Footer Contents",default:'%p / %t sounds\npostlink:"Post"\nimagelink:"Image"\nsoundlink:"Sound"',description:"What the footer displays. %p is the playing index. %t is the total sound count. postlink, imagelink, soundlink are links.",showInSettings:"textarea"},{property:"allow",default:["4cdn.org","catbox.moe","dmca.gripe","lewd.se","pomf.cat","zz.ht"],title:"Allowed Hosts",description:"Which domains sources are allowed to be loaded from.",showInSettings:!0,split:"\n"},{title:"Colors",showInSettings:!0,property:"colors",actions:[{title:"Match Theme",handler:"settings.forceBoardTheme"}],settings:[{property:"colors.text",default:"#000000",title:"Text Color"},{property:"colors.background",default:"#d6daf0",title:"Background Color"},{property:"colors.border",default:"#b7c5d9",title:"Border Color"},{property:"colors.odd_row",default:"#d6daf0",title:"Odd Row Color"},{property:"colors.even_row",default:"#b7c5d9",title:"Even Row Color"},{property:"colors.playing",default:"#98bff7",title:"Playing Row Color"},{property:"colors.dragging",default:"#c396c8",title:"Dragging Row Color"}]}]},function(e,t,n){const r={controls:n(5),display:n(6),events:n(7),footer:n(8),header:n(9),hotkeys:n(10),playlist:n(11),position:n(12),settings:n(13)},o=window.Player=e.exports={ns:ns,audio:new Audio,sounds:[],isHidden:!0,currentIndex:0,container:null,ui:{},_progressBarStyleSheets:{},config:{},$:(...e)=>o.container&&o.container.querySelector(...e),components:r,templates:{settings:n(14),css:n(15),body:n(16),header:n(17),player:n(18),controls:n(19),list:n(20),itemMenu:n(21),footer:n(22)},initialize:async function(){if(!o.initialized){o.initialized=!0;try{o.sounds=[];for(let e in r)r[e].initialize&&await r[e].initialize();if(is4chan)isChanX?o.display.initChanX():document.querySelectorAll("#settingsWindowLink, #settingsWindowLinkBot").forEach((function(e){const t=document.createTextNode("] ["),n=document.createElement("a");n.innerHTML="Sounds",n.href="javascript;",e.parentNode.insertBefore(n,e),e.parentNode.insertBefore(t,e),n.addEventListener("click",o.display.toggle)}));else{const e=document.querySelector(".navbar-inner .nav:nth-child(2)"),t=document.createElement("li"),n=document.createElement("a");n.innerHTML="Sounds",n.href="javascript;",t.appendChild(n),e.appendChild(t),n.addEventListener("click",o.display.toggle)}o.display.render()}catch(e){throw _logError("There was an error initialzing the sound player. Please check the console for details."),console.error("[4chan sounds player]",e),e}}}};for(let e in r)o[e]=r[e],(o[e].atRoot||[]).forEach(t=>o[t]=o[e][t])},function(e,t,n){"use strict";n.r(t);n(4);var r=n(2),o=n.n(r),a=n(0);async function s(){setTimeout((async function(){await o.a.initialize(),Object(a.parseFiles)(document.body),new MutationObserver((function(e){e.forEach((function(e){"childList"===e.type&&e.addedNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&Object(a.parseFiles)(e)}))}))})).observe(document.body,{childList:!0,subtree:!0})}),0)}document.addEventListener("4chanXInitFinished",(function(){isChanX&&s(),isChanX=!0,o.a.display.initChanX()})),isChanX||document.addEventListener("DOMContentLoaded",s)},function(e,t){window.ns="fc-sounds",window.is4chan=location.hostname.includes("4chan.org")||location.hostname.includes("4channel.org"),window.isChanX=document.documentElement.classList.contains("fourchan-x"),window._logError=function(e,t="error"){console.error(e),document.dispatchEvent(new CustomEvent("CreateNotification",{bubbles:!0,detail:{type:t,content:e,lifetime:5}}))},window._set=function(e,t,n){const r=t.split("."),o=r.pop(),a=r.reduce((e,t)=>e[t]||(e[t]={}),e);return a&&(a[o]=n),e},window._get=function(e,t,n){const r=t.split("."),o=r.pop(),a=r.reduce((e,t)=>e&&e[t],e);return a&&Object.prototype.hasOwnProperty.call(a,o)?a[o]:n},window.toDuration=function(e){let t=(e=Math.floor(e||0))%60;const n=Math.floor(e/60)%60,r=Math.floor(e/60/60);return t<10&&(t="0"+t),(r?r+":":"")+n+":"+t}},function(e,t){e.exports={atRoot:["togglePlay","play","pause","next","previous"],delegatedEvents:{click:{[`.${ns}-previous-button`]:()=>Player.previous(),[`.${ns}-play-button`]:"togglePlay",[`.${ns}-next-button`]:()=>Player.next(),[`.${ns}-seek-bar`]:"controls.handleSeek",[`.${ns}-volume-bar`]:"controls.handleVolume"},mousedown:{[`.${ns}-seek-bar`]:()=>Player._seekBarDown=!0,[`.${ns}-volume-bar`]:()=>Player._volumeBarDown=!0},mousemove:{[`.${ns}-seek-bar`]:e=>Player._seekBarDown&&Player.controls.handleSeek(e),[`.${ns}-volume-bar`]:e=>Player._volumeBarDown&&Player.controls.handleVolume(e)}},undelegatedEvents:{mouseleave:{[`.${ns}-seek-bar`]:e=>Player._seekBarDown&&Player.controls.handleSeek(e),[`.${ns}-volume-bar`]:e=>Player._volumeBarDown&&Player.controls.handleVolume(e)},mouseup:{body:()=>{Player._seekBarDown=!1,Player._volumeBarDown=!1}},play:{[`.${ns}-video`]:"controls.syncVideo"},pause:{[`.${ns}-video`]:"controls.syncVideo"}},audioEvents:{ended:()=>Player.next(),pause:"controls.handleAudioEvent",play:"controls.handleAudioEvent",seeked:"controls.handleAudioEvent",waiting:"controls.handleAudioEvent",timeupdate:"controls.updateDuration",loadedmetadata:"controls.updateDuration",durationchange:"controls.updateDuration",volumechange:"controls.updateVolume",loadstart:"controls.pollForLoading"},initialize:function(){Player.on("order",()=>Player.currentIndex=Player.sounds.indexOf(Player.playing)+1),Player.on("show",()=>Player._hiddenWhilePolling&&Player.controls.pollForLoading()),Player.on("hide",()=>{Player._hiddenWhilePolling=!!Player._loadingPoll,Player.controls.stopPollingForLoading()})},togglePlay:function(){Player.audio.paused?Player.play():Player.pause()},play:async function(e){if(Player.audio)try{e||Player.playing||!Player.sounds.length||(e=Player.sounds[0]);const t=Player.$(`.${ns}-video`);t.removeEventListener("loadeddata",Player.controls.playOnceLoaded),e&&(Player.playing&&(Player.playing.playing=!1),e.playing=!0,Player.playing=e,Player.audio.src=e.src,Player.currentIndex=Player.sounds.indexOf(e)+1,await Player.trigger("playsound",e)),Player.playlist.isVideo&&(t.readyState<3||Player.audio.readyState<3)?(t.addEventListener("loadeddata",Player.controls._playOnceLoaded),Player.audio.addEventListener("loadeddata",Player.controls._playOnceLoaded)):Player.audio.play()}catch(e){_logError("There was an error playing the sound. Please check the console for details."),console.error("[4chan sounds player]",e)}},_playOnceLoaded:function(){const e=Player.$(`.${ns}-video`);e.readyState>2&&Player.audio.readyState>2&&(e.removeEventListener("loadeddata",Player.controls._playOnceLoaded),Player.audio.removeEventListener("loadeddata",Player.controls._playOnceLoaded),Player.audio.play())},pause:function(){Player.audio&&Player.audio.pause()},next:function(e){Player.controls._movePlaying(1,e)},previous:function(e){Player.controls._movePlaying(-1,e)},_movePlaying:function(e,t){if(Player.audio)try{if(!Player.sounds.length)return;const n=Player.sounds.indexOf(Player.playing);if(-1===n)return Player.play(Player.sounds[0]);const r=t||"one"!==Player.config.repeat?"all"===Player.config.repeat?(n+e+Player.sounds.length)%Player.sounds.length:n+e:n,o=Player.sounds[r];o&&Player.play(o)}catch(t){_logError(`There was an error selecting the ${e>0?"next":"previous"} track. Please check the console for details.`),console.error("[4chan sounds player]",t)}},handleAudioEvent:function(){Player.controls.syncVideo(),Player.controls.updateDuration(),Player.$(`.${ns}-play-button .${ns}-play-button-display`).classList[Player.audio.paused?"add":"remove"](ns+"-play")},syncVideo:function(){if(Player.playlist.isVideo){const e=Player.audio.paused,t=Player.$(`.${ns}-video`);t&&(Player.audio.currentTime<t.duration&&(t.currentTime=Player.audio.currentTime),e?t.pause():t.play())}},pollForLoading:function(){Player._loadingPoll=Player._loadingPoll||setInterval(Player.controls.updateLoaded,1e3)},stopPollingForLoading:function(){Player._loadingPoll&&clearInterval(Player._loadingPoll),Player._loadingPoll=null},updateLoaded:function(){const e=Player.audio.buffered.length,t=e>0?Player.audio.buffered.end(e-1)/Player.audio.duration*100:0;100===t&&Player.controls.stopPollingForLoading(),Player.ui.loadedBar.style.width=t+"%"},updateDuration:function(){Player.container&&(Player.ui.currentTime.innerHTML=toDuration(Player.audio.currentTime),Player.ui.duration.innerHTML=" / "+toDuration(Player.audio.duration),Player.controls.updateProgressBarPosition(`.${ns}-seek-bar`,Player.ui.currentTimeBar,Player.audio.currentTime,Player.audio.duration))},updateVolume:function(){Player.controls.updateProgressBarPosition(`.${ns}-volume-bar`,Player.$(`.${ns}-volume-bar .${ns}-current-bar`),Player.audio.volume,1)},updateProgressBarPosition:function(e,t,n,r){n||(n=0),r||(r=0);const o=r?Math.max(0,Math.min((n||0)/r,1)):0;t.style.width=100*o+"%",Player._progressBarStyleSheets[e]&&(Player._progressBarStyleSheets[e].innerHTML=`${e} .${ns}-current-bar:after {\n\t\t\t\tmargin-right: ${-.8*(1-o)}rem;\n\t\t\t}`)},handleSeek:function(e){if(e.preventDefault(),Player.container&&Player.audio.duration&&Player.audio.duration!==1/0){const t=e.offsetX/parseInt(document.defaultView.getComputedStyle(e.eventTarget||e.target).width,10);Player.audio.currentTime=Player.audio.duration*t}},handleVolume:function(e){if(e.preventDefault(),!Player.container)return;const t=e.offsetX/parseInt(document.defaultView.getComputedStyle(e.eventTarget||e.target).width,10);Player.audio.volume=Math.max(0,Math.min(t,1)),Player.controls.updateVolume()}}},function(e,t){e.exports={atRoot:["show","hide"],delegatedEvents:{click:{[`.${ns}-close-button`]:"hide"}},initChanX:function(){if(Player.display._initedChanX)return;const e=document.getElementById("shortcuts");if(!e)return;Player.display._initedChanX=!0;const t=document.createElement("span");e.insertBefore(t,document.getElementById("shortcut-settings"));const n={id:"shortcut-sounds",class:"shortcut brackets-wrap","data-index":0};for(let e in n)t.setAttribute(e,n[e]);t.innerHTML='<a href="javascript:;" title="Sounds" class="fa fa-play-circle">Sounds</a>',t.querySelector("a").addEventListener("click",Player.display.toggle)},render:async function(){try{Player.container&&(document.body.removeChild(Player.container),document.head.removeChild(Player.stylesheet)),Player.display.updateStylesheet();const e=document.createElement("div");e.innerHTML=Player.templates.body(),Player.container=e.querySelector(`#${ns}-container`),document.body.appendChild(Player.container),Player.trigger("rendered"),Player.ui.currentTime=Player.$(`.${ns}-current-time`),Player.ui.duration=Player.$(`.${ns}-duration`),Player.ui.currentTimeBar=Player.$(`.${ns}-seek-bar .${ns}-current-bar`),Player.ui.loadedBar=Player.$(`.${ns}-seek-bar .${ns}-loaded-bar`),document.head.appendChild(Player._progressBarStyleSheets[`.${ns}-seek-bar`]=document.createElement("style")),document.head.appendChild(Player._progressBarStyleSheets[`.${ns}-volume-bar`]=document.createElement("style")),Player.controls.updateDuration(),Player.controls.updateVolume()}catch(e){throw _logError("There was an error rendering the sound player. Please check the console for details."),console.error("[4chan sounds player]",e),e}},updateStylesheet:function(){Player.stylesheet||(Player.stylesheet=document.createElement("style"),document.head.appendChild(Player.stylesheet)),Player.stylesheet.innerHTML=Player.templates.css()},setViewStyle:function(e){const{width:t,height:n}=Player.container.getBoundingClientRect();Player.config.viewStyle=e,Player.container.setAttribute("data-view-style",e),Player.position.resize(parseInt(t,10),parseInt(n,10))},toggle:function(e){e&&e.preventDefault(),"none"===Player.container.style.display?Player.show():Player.hide()},hide:function(e){if(Player.container)try{e&&e.preventDefault(),Player.container.style.display="none",Player.isHidden=!0,Player.trigger("hide")}catch(e){_logError("There was an error hiding the sound player. Please check the console for details."),console.error("[4chan sounds player]",e)}},show:async function(e){if(Player.container)try{if(e&&e.preventDefault(),!Player.container.style.display)return;Player.container.style.display=null,Player.isHidden=!1,Player.trigger("show")}catch(e){_logError("There was an error showing the sound player. Please check the console for details."),console.error("[4chan sounds player]",e)}}}},function(e,t){e.exports={atRoot:["on","off","trigger"],_events:{},_delegatedEvents:{},_undelegatedEvents:{},_audioEvents:[],initialize:function(){const e={Player:Player,...Player.components},t=Player.events._delegatedEvents,n=Player.events._undelegatedEvents,r=Player.events._audioEvents;for(name in e){const o=e[name];for(let e in o.delegatedEvents||{})t[e]||(t[e]=[]),t[e].push(o.delegatedEvents[e]);for(let e in o.undelegatedEvents||{})n[e]||(n[e]=[]),n[e].push(o.undelegatedEvents[e]);o.audioEvents&&r.push(o.audioEvents)}Player.on("rendered",(function(){for(let e in t)Player.container.addEventListener(e,(function(n){let r=[n.target];for(;r[r.length-1]!==Player.container;)r.push(r[r.length-1].parentNode);for(let o of r)for(let r of t[e])for(let e in r)if(o.matches&&o.matches(e)){n.eventTarget=o;let t=Player.events.getHandler(r[e]);if(t&&!1===t(n))return}}));Player.events.addUndelegatedListeners(Player.events._undelegatedEvents);for(let e of r)for(let t in e)Player.audio.addEventListener(t,Player.events.getHandler(e[t]))}))},addUndelegatedListeners:function(e){for(let t in e)for(let n of[].concat(e[t]))for(let e in n)document.querySelectorAll(e).forEach(r=>{const o=Player.events.getHandler(n[e]);r.removeEventListener(t,o),r.addEventListener(t,o)})},on:function(e,t){Player.events._events[e]||(Player.events._events[e]=[]),Player.events._events[e].push(t)},off:function(e,t){const n=Player.events._events[e]&&Player.events._events[e].indexOf(t);n>-1&&Player.events._events[e].splice(n,1)},trigger:async function(e,...t){const n=Player.events._events[e]||[];for(let e of n)await e(...t)},getHandler:function(e){return"string"==typeof e?_get(Player,e):e}}},function(e,t){e.exports={initialize:function(){Player.on("playsound",Player.footer.render),Player.on("add",Player.footer.render),Player.on("config",e=>"footerTemplate"===e&&Player.footer.render()),Player.on("order",()=>setTimeout(Player.footer.render,0))},render:function(){Player.$(`.${ns}-footer`).innerHTML=Player.templates.footer()}}},function(e,t){e.exports={options:{repeat:{all:{title:"Repeat All",text:"[RA]",class:"fa-repeat"},one:{title:"Repeat One",text:"[R1]",class:"fa-repeat fa-repeat-one"},none:{title:"No Repeat",text:"[R0]",class:"fa-repeat disabled"}},shuffle:{true:{title:"Shuffled",text:"[S]",class:"fa-random"},false:{title:"Ordered",text:"[O]",class:"fa-random disabled"}},viewStyle:{playlist:{title:"Hide Playlist",text:"[+]",class:"fa-compress"},image:{title:"Show Playlist",text:"[-]",class:"fa-expand"}},hoverImages:{true:{title:"Hover Images Enabled",text:"[H]",class:"fa-picture-o"},false:{title:"Hover Images Disabled",text:"[-]",class:"fa-picture-o disabled"}}},delegatedEvents:{click:{[`.${ns}-shuffle-button`]:"header.toggleShuffle",[`.${ns}-repeat-button`]:"header.toggleRepeat",[`.${ns}-reload-button`]:e=>{e.preventDefault(),Player.playlist.refresh()}}},initialize:function(){Player.on("playsound",Player.header.render)},render:function(){Player.container&&(Player.$(`.${ns}-title`).innerHTML=Player.templates.header())},toggleRepeat:function(e){try{e.preventDefault();const t=Object.keys(Player.header.options.repeat),n=t.indexOf(Player.config.repeat);Player.config.repeat=t[(n+4)%3],Player.header.render(),Player.settings.save()}catch(e){_logError("There was an error changing the repeat setting. Please check the console for details.","warning"),console.error("[4chan sounds player]",e)}},toggleShuffle:function(e){try{if(e.preventDefault(),Player.config.shuffle=!Player.config.shuffle,Player.header.render(),Player.config.shuffle){const e=Player.sounds;for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}else Player.sounds.sort((e,t)=>e.id-t.id);Player.playlist.render(),Player.settings.save(),Player.trigger("order")}catch(e){_logError("There was an error changing the shuffle setting. Please check the console for details.","warning"),console.error("[4chan sounds player]",e)}}}},function(e,t,n){const r=n(1);e.exports={initialize:function(){Player.on("rendered",Player.hotkeys.apply)},_keyMap:{" ":"space",arrowleft:"left",arrowright:"right",arrowup:"up",arrowdown:"down"},addHandler:()=>{Player.hotkeys.removeHandler(),document.body.addEventListener("keydown",Player.hotkeys.handle)},removeHandler:()=>{document.body.removeEventListener("keydown",Player.hotkeys.handle)},apply:function(){const e=Player.config.hotkeys;Player.hotkeys.removeHandler(),Player.off("show",Player.hotkeys.addHandler),Player.off("hide",Player.hotkeys.removeHandler),"always"===e?Player.hotkeys.addHandler():"open"===e&&(Player.isHidden||Player.hotkeys.addHandler(),Player.on("show",Player.hotkeys.addHandler),Player.on("hide",Player.hotkeys.removeHandler))},handle:function(e){if(["INPUT","SELECT","TEXTAREA","INPUT"].includes(e.target.nodeName)||Player.isHidden&&("always"!==Player.config.hotkeys||!Player.sounds.length))return;const t=e.key.toLowerCase(),n=Player.config.hotkey_bindings||{};for(let o in n){const a=n[o],s=t===a.key&&!!a.shiftKey==!!e.shiftKey&&!!a.ctrlKey==!!e.ctrlKey&&!!a.metaKey==!!e.metaKey&&(!a.ignoreRepeat||!e.repeat)&&r.find(e=>"hotkey_bindings"===e.property).settings.find(e=>e.property==="hotkey_bindings."+o);if(s)return e.preventDefault(),_get(Player,s.keyHandler)()}},stringifyKey:function(e){let t=e.key.toLowerCase();return Player.hotkeys._keyMap[t]&&(t=Player.hotkeys._keyMap[t]),(e.ctrlKey?"Ctrl+":"")+(e.shiftKey?"Shift+":"")+(e.metaKey?"Meta+":"")+t},parseKey:function(e){const t=e.split("+");let n=t.pop();Object.keys(Player.hotkeys._keyMap).find(e=>Player.hotkeys._keyMap[e]===n&&(n=e));const r={key:n};return t.forEach(e=>r[e.toLowerCase()+"Key"]=!0),r},volumeUp:function(){Player.audio.volume=Math.min(Player.audio.volume+.05,1)},volumeDown:function(){Player.audio.volume=Math.max(Player.audio.volume-.05,0)}}},function(e,t,n){var{parseFiles:r}=n(0);e.exports={atRoot:["add","remove"],delegatedEvents:{click:{[`.${ns}-viewStyle-button`]:"playlist.toggleView",[`.${ns}-hoverImages-button`]:"playlist.toggleHoverImages",[`.${ns}-remove-link`]:"playlist.handleRemove",[`.${ns}-list-item`]:"playlist.handleSelect"},mousemove:{[`.${ns}-list-item`]:"playlist.moveHoverImage"},dragstart:{[`.${ns}-list-item`]:"playlist.handleDragStart"},dragenter:{[`.${ns}-list-item`]:"playlist.handleDragEnter"},dragend:{[`.${ns}-list-item`]:"playlist.handleDragEnd"},dragover:{[`.${ns}-list-item`]:e=>e.preventDefault()},drop:{[`.${ns}-list-item`]:e=>e.preventDefault()}},undelegatedEvents:{click:{body:"playlist.closeMenus"},keydown:{body:e=>"Escape"===e.key&&Player.playlist.closeMenus()},mouseenter:{[`.${ns}-list-item`]:"playlist.showHoverImage"},mouseleave:{[`.${ns}-list-item`]:"playlist.removeHoverImage"}},initialize:function(){Player.on("playsound",e=>{Player.playlist.showImage(e),Player.playlist.render()})},render:function(){Player.container&&(Player.$(`.${ns}-list-container`)&&(Player.$(`.${ns}-list-container`).innerHTML=Player.templates.list()),Player.events.addUndelegatedListeners({mouseenter:Player.playlist.undelegatedEvents.mouseenter,mouseleave:Player.playlist.undelegatedEvents.mouseleave}))},showImage:function(e,t){if(!Player.container)return;let n=Player.playlist.isVideo=!t&&e.image.endsWith(".webm");try{const r=Player.$(`.${ns}-image`),o=Player.$(`.${ns}-video`);r.src="",r.src=n||t?e.thumb:e.image,o.src=n?e.image:null,Player.$(`.${ns}-image-link`).href=e.image,Player.$(`.${ns}-image-link`).classList[n?"add":"remove"](ns+"-show-video")}catch(e){_logError("There was an error display the sound player image. Please check the console for details."),console.error("[4chan sounds player]",e)}},toggleView:function(e){if(!Player.container)return;e&&e.preventDefault();let t="playlist"===Player.config.viewStyle?"image":"playlist";try{Player.display.setViewStyle(t),Player.header.render(),Player.settings.save()}catch(e){_logError("There was an error switching the view style. Please check the console for details.","warning"),console.error("[4chan sounds player]",e)}},add:function(e,t,n,r,o){try{if(Player.sounds.find(e=>e.id===t))return;const a={title:e,src:n,id:t,thumb:r,image:o};let s=Player.config.shuffle?Math.floor(Math.random()*Player.sounds.length-1):Player.sounds.findIndex(e=>e.id>t);s<0&&(s=Player.sounds.length),Player.sounds.splice(s,0,a),Player.container&&(Player.playlist.render(),1===Player.sounds.length&&(/\/thread\//.test(location.href)&&Player.config.autoshow&&Player.show(),Player.playlist.showImage(a)),Player.trigger("add",a))}catch(a){_logError("There was an error adding to the sound player. Please check the console for details."),console.log("[4chan sounds player]",e,t,n,r,o),console.error("[4chan sounds player]",a)}},remove:function(e){const t=Player.sounds.indexOf(e);Player.playing===e&&(Player.pause(),Player.next(!0)),t>-1&&Player.sounds.splice(t,1),Player.playlist.render(),Player.$(`.${ns}-count`).innerHTML=Player.sounds.length},handleRemove:function(e){const t=e.eventTarget.closest(`.${ns}-list-item`).getAttribute("data-id"),n=t&&Player.sounds.find(e=>e.id===""+t);n&&Player.remove(n)},closeMenus:function(e){const t=e&&e.target.closest(`.${ns}-list-item`);document.querySelectorAll(`.${ns}-item-menu`).forEach(e=>{const n=e.parentNode;n!==t&&(n.removeChild(e),n.classList.remove(`.${ns}-has-menu`))})},handleSelect:function(e){const t=e.target.closest(`.${ns}-item-menu`),n=t||e.eventTarget.querySelector(`.${ns}-item-menu`),r=e.eventTarget.getAttribute("data-id"),o=e.target.closest(`.${ns}-item-menu-button`),a=r&&Player.sounds.find(e=>e.id===""+r);if(n)e.eventTarget.removeChild(n),e.eventTarget.classList.remove(`.${ns}-has-menu`);else if(o){e.preventDefault(),e.eventTarget.hoverImage&&(e.eventTarget.hoverImage.parentNode.removeChild(e.eventTarget.hoverImage),delete e.eventTarget.hoverImage);const t=document.createElement("div");t.innerHTML=Player.templates.itemMenu({top:e.clientY,left:e.clientX,sound:a});const n=t.children[0];e.eventTarget.appendChild(n),e.eventTarget.classList.remove(`.${ns}-has-menu`);const r=document.defaultView.getComputedStyle(n),o=parseInt(r.width,10),s=parseInt(r.height,10);e.clientX-o>0&&(n.style.left=e.clientX-o+"px"),e.clientY+s>document.documentElement.clientHeight-40&&(n.style.top=e.clientY-s+"px"),n.querySelectorAll(".entry").forEach(e=>{e.addEventListener("mouseenter",Player.playlist.setFocusedMenuItem),e.addEventListener("mouseleave",Player.playlist.unsetFocusedMenuItem)})}o||t||(e.preventDefault(),a&&Player.play(a))},setFocusedMenuItem:function(e){e.currentTarget.classList.add("focused")},unsetFocusedMenuItem:function(e){e.currentTarget.classList.remove("focused")},refresh:function(){r(document.body)},toggleHoverImages:function(e){e&&e.preventDefault(),Player.config.hoverImages=!Player.config.hoverImages,Player.header.render(),Player.settings.save()},showHoverImage:function(e){if(e.currentTarget.hoverImage||!Player.config.hoverImages||Player.$(`.${ns}-item-menu`))return;const t=e.currentTarget.getAttribute("data-id"),n=Player.sounds.find(e=>e.id===""+t),r=document.createElement("img");e.currentTarget.parentNode.appendChild(r),e.currentTarget.hoverImage=r,r.setAttribute("class",ns+"-hover-image"),r.setAttribute("src",n.thumb),Player.playlist.positionHoverImage(e,r)},moveHoverImage:function(e){e.eventTarget.hoverImage&&Player.playlist.positionHoverImage(e,e.eventTarget.hoverImage)},positionHoverImage:function(e,t){const{width:n,height:r}=t.getBoundingClientRect(),o=document.documentElement.clientWidth-n-5;t.style.left=Math.min(e.clientX,o)+5+"px",t.style.top=e.clientY-r-10+"px"},removeHoverImage:function(e){e.currentTarget.hoverImage&&e.currentTarget.parentNode.removeChild(e.currentTarget.hoverImage),delete e.currentTarget.hoverImage},handleDragStart:function(e){Player.playlist._dragging=e.eventTarget,Player._hoverImages=Player.config.hoverImages,Player.config.hoverImages=!1,e.eventTarget.classList.add(ns+"-dragging"),e.dataTransfer.setDragImage(new Image,0,0),e.dataTransfer.dropEffect="move",e.dataTransfer.setData("text/plain",e.eventTarget.getAttribute("data-id"))},handleDragEnter:function(e){e.preventDefault();const t=Player.playlist._dragging,n=t.getAttribute("data-id");let r=e.target.closest&&e.target.closest(`.${ns}-list-item`);if(!r||t===r)return;const o=Player.sounds.findIndex(e=>e.id===n),a=t.parentNode;if(4&t.compareDocumentPosition(r)&&(r=r.nextSibling),r){const e=r.getAttribute("data-id"),n=Player.sounds.findIndex(t=>t.id===e),s=o<n?n-1:n;a.insertBefore(t,r),Player.sounds.splice(s,0,Player.sounds.splice(o,1)[0])}else Player.sounds.push(Player.sounds.splice(o,1)[0]),a.appendChild(t);Player.trigger("order")},handleDragEnd:function(e){e.preventDefault(),delete Player.playlist._dragging,e.eventTarget.classList.remove(ns+"-dragging"),Player.config.hoverImages=Player._hoverImages,Player.playlist.render()}}},function(e,t){e.exports={delegatedEvents:{mousedown:{[`.${ns}-title`]:"position.initMove",[`.${ns}-expander`]:"position.initResize"}},initialize:function(){Player.on("show",(async function(){const[e,t]=(await GM.getValue(ns+".position")||"").split(":"),[n,r]=(await GM.getValue(ns+".size")||"").split(":");+e&&+t&&Player.position.move(e,t,!0),+n&&+r&&Player.position.resize(n,r),Player.config.limitPostWidths&&(Player.position.setPostWidths(),window.addEventListener("scroll",Player.position.setPostWidths))})),Player.on("hide",(function(){Player.position.setPostWidths(),window.removeEventListener("scroll",Player.position.setPostWidths)})),Player.on("config",e=>{"limitPostWidths"!==e&&"minPostWidth"!==e||(window.removeEventListener("scroll",Player.position.setPostWidths),Player.position.setPostWidths(),Player.config.limitPostWidths&&window.addEventListener("scroll",Player.position.setPostWidths))})},setPostWidths:function(){const e=document.documentElement.clientWidth-Player.container.offsetLeft+10,t=is4chan?".thread > .postContainer":".posts > article.post",n=!Player.isHidden&&Player.config.limitPostWidths,r=Player.container.offsetTop,o=Player.container.getBoundingClientRect().height+r;document.querySelectorAll(t).forEach(t=>{const a=n&&t.getBoundingClientRect(),s=n&&a.top+a.height>r&&a.top<o;t.style.maxWidth=s?`calc(100% - ${e}px)`:null,t.style.minWidth=s?""+Player.config.minPostWidth:null})},initResize:function(e){e.preventDefault(),Player._startX=e.clientX,Player._startY=e.clientY;let{width:t,height:n}=Player.container.getBoundingClientRect();Player._startWidth=t,Player._startHeight=n,document.documentElement.addEventListener("mousemove",Player.position.doResize,!1),document.documentElement.addEventListener("mouseup",Player.position.stopResize,!1)},doResize:function(e){e.preventDefault(),Player.position.resize(Player._startWidth+e.clientX-Player._startX,Player._startHeight+e.clientY-Player._startY)},stopResize:function(){const{width:e,height:t}=Player.container.getBoundingClientRect();document.documentElement.removeEventListener("mousemove",Player.position.doResize,!1),document.documentElement.removeEventListener("mouseup",Player.position.stopResize,!1),GM.setValue(ns+".size",e+":"+t)},resize:function(e,t){if(!Player.container)return;const{bottom:n}=Player.position.getHeaderOffset();t=Math.min(t,document.documentElement.clientHeight-Player.container.offsetTop-n),e=Math.min(e-2,document.documentElement.clientWidth-Player.container.offsetLeft),Player.container.style.width=e+"px";const r="playlist"===Player.config.viewStyle?Player.$(`.${ns}-list-container`):"image"===Player.config.viewStyle?Player.$(`.${ns}-image-link`):"settings"===Player.config.viewStyle?Player.$(`.${ns}-settings`):null,o=Player.container.getBoundingClientRect().height-r.getBoundingClientRect().height;r.style.height=Math.max(10,t-o)+"px"},initMove:function(e){e.preventDefault(),Player.$(`.${ns}-title`).style.cursor="grabbing";const{width:t,height:n}=Player.container.getBoundingClientRect();Player.position.resize(t,n),Player._offsetX=e.clientX-Player.container.offsetLeft,Player._offsetY=e.clientY-Player.container.offsetTop,document.documentElement.addEventListener("mousemove",Player.position.doMove,!1),document.documentElement.addEventListener("mouseup",Player.position.stopMove,!1)},doMove:function(e){e.preventDefault(),Player.position.move(e.clientX-Player._offsetX,e.clientY-Player._offsetY)},stopMove:function(e){document.documentElement.removeEventListener("mousemove",Player.position.doMove,!1),document.documentElement.removeEventListener("mouseup",Player.position.stopMove,!1),Player.$(`.${ns}-title`).style.cursor=null,GM.setValue(ns+".position",parseInt(Player.container.style.left,10)+":"+parseInt(Player.container.style.top,10))},move:function(e,t,n){if(!Player.container)return;const{top:r,bottom:o}=Player.position.getHeaderOffset(),{width:a,height:s}=Player.container.getBoundingClientRect(),l=n?1/0:document.documentElement.clientWidth-a,i=n?1/0:document.documentElement.clientHeight-s-o;Player.container.style.left=Math.max(0,Math.min(e,l))+"px",Player.container.style.top=Math.max(r,Math.min(t,i))+"px",Player.position.setPostWidths()},getHeaderOffset:function(){const e=document.documentElement.classList,t=e.contains("fixed"),n=t?document.querySelector("#header-bar").getBoundingClientRect().height:0;return{top:t&&e.contains("top-header")?n:0,bottom:t&&e.contains("bottom-header")?n:0}}}},function(e,t,n){const r=n(1);e.exports={delegatedEvents:{click:{[`.${ns}-config-button`]:"settings.toggle",[`.${ns}-setting-action`]:"settings.handleAction"},focusout:{[`.${ns}-settings input, .${ns}-settings textarea`]:"settings.handleChange"},change:{[`.${ns}-settings input[type=checkbox], .${ns}-settings select`]:"settings.handleChange"},keydown:{[`.${ns}-key-input`]:"settings.handleKeyChange"}},initialize:async function(){Player.settings.applyBoardTheme(),Player.config=r.reduce((function(e,t){return t.settings?(t.settings.forEach(n=>{let r={...t,...n};_set(e,r.property,r.default)}),e):_set(e,t.property,t.default)}),{}),await Player.settings.load(),Player.on("hide",(function(){Player.config.pauseOnHide&&Player.pause()}))},render:function(){Player.$(`.${ns}-settings`).innerHTML=Player.templates.settings()},forceBoardTheme:function(){Player.settings.applyBoardTheme(!0),Player.settings.save()},applyBoardTheme:function(e){const t=document.createElement("div");t.setAttribute("class",is4chan?"post reply":"post_wrapper"),document.body.appendChild(t);const n=document.defaultView.getComputedStyle(t),o={"colors.text":"color","colors.background":"backgroundColor","colors.odd_row":"backgroundColor","colors.border":"borderBottomColor","colors.even_row":n.borderBottomColor===n.color?"backgroundColor":"borderBottomColor"};r.find(e=>"colors"===e.property).settings.forEach(t=>{const r=e||t.default===_get(Player.config,t.property);o[t.property]&&(t.default=n[o[t.property]]),r&&_set(Player.config,t.property,t.default)}),document.body.removeChild(t),delete t,Player.stylesheet&&Player.display.updateStylesheet(),Player.container&&Player.settings.render()},save:function(){try{const e=r.reduce((function e(t,n){if(n.settings)n.settings.forEach(r=>e(t,{property:n.property,default:n.default,...r}));else{const e=_get(Player.config,n.property);void 0!==e&&e!==n.default&&_set(t,n.property,e)}return t}),{});return GM.setValue(ns+".settings",JSON.stringify(e))}catch(e){_logError("There was an error saving the sound player settings. Please check the console for details."),console.error("[4chan sounds player]",e)}},load:async function(){try{let e=await GM.getValue(ns+".settings");if(!e)return;try{e=JSON.parse(e),r.forEach((function t(n){if(n.settings)return n.settings.forEach(e=>t({property:n.property,default:n.default,...e}));const r=_get(e,n.property);void 0!==r&&_set(Player.config,n.property,r)}))}catch(e){return void console.error(e)}}catch(e){_logError("There was an error loading the sound player settings. Please check the console for details."),console.error("[4chan sounds player]",e)}},toggle:function(e){try{e.preventDefault(),"settings"===Player.config.viewStyle?Player.display.setViewStyle(Player._preSettingsView||"playlist"):(Player._preSettingsView=Player.config.viewStyle,Player.display.setViewStyle("settings"))}catch(e){throw _logError("There was an error rendering the sound player settings. Please check the console for details."),console.error("[4chan sounds player]",e),e}},handleChange:function(e){try{const t=e.eventTarget,n=t.getAttribute("data-property");let o;r.find((function(e){if(e.property===n)return o=e;if(e.settings){let t=e.settings.find(e=>e.property===n);return t&&(o={...e,settings:null,...t})}return!1}));const a=_get(Player.config,n);let s=t["checkbox"===t.getAttribute("type")?"checked":"value"];o.parse&&(s=_get(Player,o.parse)(s)),o&&o.split&&(s=s.split(decodeURIComponent(o.split))),a!==s&&(_set(Player.config,n,s),Player.stylesheet.innerHTML=Player.templates.css(),Player.settings.save(),Player.trigger("config",n,s,a)),o&&o.handler&&_get(Player,o.handler,()=>null)(s)}catch(e){_logError("There was an error updating the setting. Please check the console for details."),console.error("[4chan sounds player]",e)}},handleKeyChange:function(e){e.preventDefault(),"Shift"!==e.key&&"Control"!==e.key&&"Meta"!==e.key&&(e.eventTarget.value=Player.hotkeys.stringifyKey(e))},handleAction:function(e){e.preventDefault();const t=e.eventTarget.getAttribute("data-handler"),n=_get(Player,t);n&&n()}}},function(e,t,n){e.exports=e=>n(1).filter(e=>e.showInSettings).map((function e(t){const n=t.description;let r=`<div class="${t.isSubSetting?ns+"-col":ns+"-setting-header"} ${n?ns+"-has-description":""}" ${n?`title="${n}"`:""}>\n\t\t\t${t.title}\n\t\t\t${(t.actions||[]).map(e=>`<a href="javascript;" class="${ns}-setting-action" data-handler="${e.handler}">${e.title}</a>`)}\n\t\t</div>`;if(t.settings)return r+=`<div class="${ns}-row ${ns}-sub-settings">`+t.settings.map(n=>e({...t,actions:null,settings:null,description:null,...n,isSubSetting:!0})).join("")+"</div>",r;let o=_get(Player.config,t.property,t.default),a=t.class?`class="${t.class}"`:"";t.format&&(o=_get(Player,t.format)(o));let s=typeof o;return t.isSubSetting&&(r+=`<div class="${ns}-col">`),"boolean"===s?r+=`<input type="checkbox" ${a} data-property="${t.property}" ${o?"checked":""} style="margin-bottom: .25rem"></input>`:"textarea"===t.showInSettings||"object"===s?(t.split?o=o.join(t.split):"object"===s&&(o=JSON.stringify(o,null,4)),r+=`<textarea ${a} data-property="${t.property}">${o}</textarea>`):t.options?r+=`<select ${a} data-property="${t.property}" style="margin-bottom: .25rem">`+Object.keys(t.options).map(e=>`<option value="${e}" ${o===e?"selected":""}>${t.options[e]}</option>`).join("")+"</select>":r+=`<input type="text" ${a} data-property="${t.property}" value="${o}"></input>`,t.isSubSetting&&(r+=`</div><div class="${ns}-col" style="min-width: 100%"></div>`),r})).join("")},function(e,t){e.exports=e=>`.${ns}-controls{align-items:center;padding:.5rem;border-bottom:solid 1px ${Player.config.colors.border};background:#3f3f44}.${ns}-media-control{height:1.5rem;width:1.5rem;display:flex;justify-content:center;align-items:center}.${ns}-media-control>div{height:1rem;width:.8rem;background:#fff}.${ns}-media-control:hover>div{background:#00b6f0}.${ns}-play-button-display{clip-path:polygon(10% 10%, 10% 90%, 35% 90%, 35% 10%, 65% 10%, 65% 90%, 90% 90%, 90% 10%, 10% 10%)}.${ns}-play-button-display.${ns}-play{clip-path:polygon(0 0, 0 100%, 100% 50%, 0 0)}.${ns}-previous-button-display,.${ns}-next-button-display{clip-path:polygon(10% 10%, 10% 90%, 30% 90%, 30% 50%, 90% 90%, 90% 10%, 30% 50%, 30% 10%, 10% 10%)}.${ns}-next-button-display{transform:scale(-1, 1)}.${ns}-current-time{color:#fff}.${ns}-duration{color:#909090}.${ns}-progress-bar{height:1.5rem;display:flex;align-items:center;margin:0 1rem}.${ns}-progress-bar .${ns}-full-bar{height:.3rem;width:100%;background:#131314;border-radius:1rem;position:relative}.${ns}-progress-bar .${ns}-full-bar>div{position:absolute;top:0;bottom:0;border-radius:1rem}.${ns}-progress-bar .${ns}-full-bar .${ns}-loaded-bar{background:#5a5a5b}.${ns}-progress-bar .${ns}-full-bar .${ns}-current-bar{display:flex;justify-content:flex-end;align-items:center}.${ns}-progress-bar .${ns}-full-bar .${ns}-current-bar:after{content:"";background:#fff;height:.8rem;min-width:.8rem;border-radius:1rem;box-shadow:rgba(0,0,0,.76) 0 0 3px 0}.${ns}-progress-bar:hover .${ns}-current-bar:after{background:#00b6f0}.${ns}-seek-bar .${ns}-current-bar{background:#00b6f0}.${ns}-volume-bar .${ns}-current-bar{background:#fff}.${ns}-volume-bar{width:3.5rem}.${ns}-footer{padding:.15rem .25rem;border-top:solid 1px ${Player.config.colors.border}}.${ns}-footer .${ns}-expander{position:absolute;bottom:0px;right:0px;height:.75rem;width:.75rem;cursor:se-resize;background:linear-gradient(to bottom right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0) 50%, ${Player.config.colors.border} 55%, ${Player.config.colors.border} 100%)}.${ns}-title{cursor:grab;text-align:center;border-bottom:solid 1px ${Player.config.colors.border};padding:.25rem 0}html.fourchan-x .${ns}-title .fa-repeat.fa-repeat-one::after{content:"1";font-size:.5rem;visibility:visible;margin-left:-1px}.${ns}-image-link{text-align:center;display:flex;justify-items:center;justify-content:center;border-bottom:solid 1px ${Player.config.colors.border}}.${ns}-image-link .${ns}-video{display:none}.${ns}-image,.${ns}-video{height:100%;width:100%;object-fit:contain}.${ns}-image-link.${ns}-show-video .${ns}-video{display:block}.${ns}-image-link.${ns}-show-video .${ns}-image{display:none}#${ns}-container{position:fixed;background:${Player.config.colors.background};border:1px solid ${Player.config.colors.border};min-height:200px;min-width:100px;color:${Player.config.colors.text}}.${ns}-row{display:flex;flex-wrap:wrap}.${ns}-col-auto{flex:0 0 auto;width:auto;max-width:100%}.${ns}-col{flex-basis:0;flex-grow:1;max-width:100%;width:100%}html.fourchan-x #${ns}-container .fa{font-size:0;visibility:hidden;margin:0 .15rem}.${ns}-truncate-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.${ns}-list-container{overflow-y:auto}.${ns}-list-container .${ns}-hover-image{position:fixed;max-height:125px;max-width:125px}.${ns}-list-container .${ns}-list-item{list-style-type:none;padding:.15rem .25rem;white-space:nowrap;text-overflow:ellipsis;cursor:pointer;background:${Player.config.colors.odd_row};overflow:hidden;height:1rem}.${ns}-list-container .${ns}-list-item.playing{background:${Player.config.colors.playing} !important}.${ns}-list-container .${ns}-list-item:nth-child(2n){background:${Player.config.colors.even_row}}.${ns}-list-container .${ns}-list-item .${ns}-item-menu-button{right:.25rem;display:none}.${ns}-list-container .${ns}-list-item:hover .${ns}-item-menu-button{display:inline-block}.${ns}-list-container .${ns}-list-item .${ns}-item-menu{position:fixed;background:${Player.config.colors.background};background:${Player.config.colors.background};border-color:${Player.config.colors.border};box-shadow:0 1px 2px rgba(0,0,0,.15);border-radius:3px;padding-top:1px;padding-bottom:3px}.${ns}-list-container .${ns}-list-item .${ns}-item-menu a.entry{margin:.25rem;display:block}.${ns}-list-container .${ns}-list-item.${ns}-dragging{background:${Player.config.colors.dragging}}.${ns}-settings{display:none;padding:0 .25rem;height:100%;overflow:auto}.${ns}-settings .${ns}-setting-header{font-weight:600;margin:.5rem 0}.${ns}-settings .${ns}-setting-header.${ns}-has-description{cursor:help}.${ns}-settings .${ns}-setting-action{font-weight:normal;text-decoration:underline;margin-left:.25rem}.${ns}-settings textarea{border:solid 1px ${Player.config.colors.border};min-width:100%;min-height:4rem;box-sizing:border-box}#${ns}-container[data-view-style=settings] .${ns}-player{display:none}#${ns}-container[data-view-style=settings] .${ns}-settings{display:block}#${ns}-container[data-view-style=image] .${ns}-list-container{display:none}#${ns}-container[data-view-style=playlist] .${ns}-image-link{height:125px !important}#${ns}-container[data-view-style=image] .${ns}-image-link{height:auto;min-height:125px}`},function(e,t){e.exports=e=>`<div id="${ns}-container" data-view-style="${Player.config.viewStyle}" style="top: 30px; left: 0px; width: 350px; display: none;">\n\t<div class="${ns}-title ${ns}-row">\n\t\t${Player.templates.header(e)}\n\t</div>\n\t<div class="${ns}-view-container">\n\t\t<div class="${ns}-player">\n\t\t\t${Player.templates.player(e)}\n\t\t</div>\n\t\t<div class="${ns}-settings" style="height: 400px">\n\t\t\t${Player.templates.settings(e)}\n\t\t</div>\n\t</div>\n\t<div class="${ns}-footer">\n\t\t${Player.templates.footer(e)}\n\t</div>\n</div>`},function(e,t){e.exports=e=>`<div class="${ns}-col-auto" style="margin-left: 0.25rem;">`+Object.keys(Player.header.options).map(e=>{let t=Player.header.options[e][Player.config[e]]||Player.header.options[e][Object.keys(Player.header.options[e])[0]];return`<a class="${ns}-${e}-button fa ${t.class}" title="${t.title}" href="javascript;">\n\t\t\t${t.text}\n\t\t</a>`}).join("")+`\n</div>\n<div class="${ns}-col ${ns}-truncate-text">\n\t${Player.playing?Player.playing.title:"4chan Sounds"}\n</div>\n<div class="${ns}-col-auto" style="margin-right: 0.25rem;">\n\t<a class="${ns}-reload-button fa fa-refresh" title="Reload the playlist" href="javascript;">[R]</a>\n\t<a class="${ns}-config-button fa fa-wrench" title="Settings" href="javascript;">[S]</a>\n\t<a class="${ns}-close-button fa fa-times" href="javascript;">X</a>\n</div>`},function(e,t){e.exports=e=>`<a class="${ns}-image-link" style="height: 128px" target="_blank">\n\t<img class="${ns}-image"></img>\n\t<video class="${ns}-video"></video>\n</a>\n<div class="${ns}-controls ${ns}-row">\n\t${Player.templates.controls(e)}\n</div>\n<div class="${ns}-list-container" style="height: 100px">\n\t${Player.templates.list(e)}\n</div>`},function(e,t){e.exports=e=>`<div class="${ns}-col-auto ${ns}-row" href="javascript;">\n\t<div class="${ns}-media-control ${ns}-previous-button">\n\t\t<div class="${ns}-previous-button-display"></div>\n\t</div>\n\t<div class="${ns}-media-control ${ns}-play-button">\n\t\t<div class="${ns}-play-button-display ${!Player.audio||Player.audio.paused?ns+"-play":""}"></div>\n\t</div>\n\t<div class="${ns}-media-control ${ns}-next-button">\n\t\t<div class="${ns}-next-button-display"></div>\n\t</div>\n</div>\n<div class="${ns}-col">\n\t<div class="${ns}-seek-bar ${ns}-progress-bar">\n\t\t<div class="${ns}-full-bar">\n\t\t\t<div class="${ns}-loaded-bar"></div>\n\t\t\t<div class="${ns}-current-bar"></div>\n\t\t</div>\n\t</div>\n</div>\n<div class="${ns}-col-auto">\n\t<span class="${ns}-current-time">0:00</span><span class="${ns}-duration"> / 0:00</span>\n</div>\n<div class="${ns}-col-auto">\n\t<div class="${ns}-volume-bar ${ns}-progress-bar">\n\t\t<div class="${ns}-full-bar">\n\t\t\t<div class="${ns}-current-bar" style="width: ${100*Player.audio.volume}%"></div>\n\t\t</div>\n\t</div>\n</div>`},function(e,t){e.exports=e=>Player.sounds.map(e=>`<div class="${ns}-list-item ${ns}-row ${e.playing?"playing":""}" data-id="${e.id}" draggable="true">\n\t\t<div class="${ns}-col ${ns}-truncate-text">\n\t\t\t<span title="${e.title}">${e.title}</span>\n\t\t</div>\n\t\t<div class="${ns}-col-auto ${ns}-item-menu-button">\n\t\t\t<i class="fa fa-angle-down">▼</i>\n\t\t</div>\n\t</div>`).join("")},function(e,t){e.exports=e=>`<div class="${ns}-item-menu dialog" id="menu" tabindex="0" data-type="post" style="top: ${e.top}px; left: ${e.left}px;">\n\t<a class="${ns}-remove-link entry focused" href="javascript:;">Remove</a>\n\t<a class="${ns}-show-post-link entry" href="#${(is4chan?"p":"")+e.sound.id}">Show Post</a>\n\t<a class="${ns}-show-post-link entry" href="${e.sound.image}" target="_blank">Open Image</a>\n\t<a class="${ns}-show-post-link entry" href="${e.sound.src}" target="_blank">Open Sound</a>\n</div>`},function(e,t){e.exports=e=>Player.config.footerTemplate.replace(/%p/g,Player.currentIndex||0).replace(/%t/g,Player.sounds.length).replace(/postlink(:"([^"]+)")?/g,(function(e,t,n){return Player.playing?`<a href="#${(is4chan?"p":"")+Player.playing.id}">${n||"Post"}</a>`:""})).replace(/imagelink(:"([^"]+)")?/g,(function(e,t,n){return Player.playing?`<a href="${Player.playing.image}" target="_blank">${n||"Image"}</a>`:""})).replace(/soundlink(:"([^"]+)")?/g,(function(e,t,n){return Player.playing?`<a href="${Player.playing.src}" target="_blank">${n||"Sound"}</a>`:""}))+`<div class="${ns}-expander"></div>`}]);